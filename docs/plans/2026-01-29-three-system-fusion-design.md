# LiYe OS + Amazon Growth Engine + Moltbot ä¸‰æ–¹èåˆè®¾è®¡æ–‡æ¡£

**Version**: 1.0
**Created**: 2026-01-29
**Author**: Claude + LiYe Expert Team (Elon Session)
**Status**: Approved for Implementation

---

## Executive Summary

æœ¬æ–‡æ¡£å®šä¹‰äº† LiYe OSã€Amazon Growth Engine å’Œ Moltbot ä¸‰ä¸ªç³»ç»Ÿçš„æ·±åº¦èåˆæ¶æ„ã€‚åŸºäºç¬¬ä¸€æ€§åŸç†åˆ†æï¼Œä¸‰ä¸ªç³»ç»Ÿåœ¨ä¸åŒå±‚æ¬¡è§£å†³ä¸åŒé—®é¢˜ï¼Œå½¢æˆå‚ç›´äº’è¡¥çš„å®Œæ•´æ ˆï¼š

| ç³»ç»Ÿ | å±‚æ¬¡ | æ ¸å¿ƒé—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|------|---------|---------|
| **Moltbot** | è§¦è¾¾å±‚ (Layer 4) | ç”¨æˆ·å¦‚ä½•æ— å¤„ä¸åœ¨åœ°è§¦è¾¾ AIï¼Ÿ | å¤šé€šé“ç½‘å…³ + è¯­éŸ³å”¤é†’ |
| **LiYe OS** | æ²»ç†å±‚ (Layer 2-3) | AI å†³ç­–å¦‚ä½•å¯ä¿¡ä»»ã€å¯è¿½æº¯ï¼Ÿ | T1/T2/T3 ä¸–ç•Œæ¨¡å‹ + å®ªæ³•æ²»ç† |
| **Amazon Engine** | é¢†åŸŸå±‚ (Layer 1) | å¦‚ä½•è‡ªåŠ¨ä¼˜åŒ– Amazon ç”µå•†ï¼Ÿ | ç­–ç•¥å¼•æ“ + ActionSpec + æ‰§è¡Œç®¡é“ |

---

## 1. Architecture Overview

### 1.1 Four-Layer Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Layer 4: è§¦è¾¾å±‚ (Moltbot)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚WhatsApp â”‚ â”‚Telegram â”‚ â”‚ iMessageâ”‚ â”‚ Discord â”‚ â”‚  Voice  â”‚ â”‚ Canvas  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Moltbot Gateway (ws://18789)                       â”‚  â”‚
â”‚  â”‚   Session Manager â”‚ Channel Router â”‚ Canvas Renderer â”‚ Pi Agent      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Layer 3: ç¼–æ’å±‚ (Agent Orchestration)                  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                        Unified Dispatcher                               â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚ Low Risk Route              â”‚  â”‚ High Risk Route                 â”‚  â”‚â”‚
â”‚  â”‚  â”‚ â†’ Pi Agent (fast response)  â”‚  â”‚ â†’ LiYe AgentExecutor (governed) â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  External Orchestrators (Optional):                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ CrewAI  â”‚ â”‚  Dify   â”‚ â”‚   n8n   â”‚ â”‚AutoGen  â”‚ â”‚LangGraphâ”‚               â”‚
â”‚  â”‚   P0    â”‚ â”‚   P1    â”‚ â”‚   P3    â”‚ â”‚   P4    â”‚ â”‚   P5    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Layer 2: æ²»ç†å±‚ (LiYe Governance Kernel)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Gate           â†’   Verdict        â†’   Replay        â†’   Evidence      â”‚â”‚
â”‚  â”‚  (é£é™©è¯„ä¼°)          (åˆ¤å®šç”Ÿæˆ)          (ç¡®å®šæ€§éªŒè¯)      (å®¡è®¡è¯æ®é“¾)    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â†“ å†³ç­–è¾“å‡º                                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚           â”‚  ALLOW  â”‚ DEGRADE â”‚  BLOCK  â”‚ UNKNOWN â”‚                         â”‚
â”‚           â”‚ æ‰§è¡Œ âœ“  â”‚ è°¨æ…æ‰§è¡Œ â”‚ æ‹’ç» âœ—  â”‚ æ‹’ç» âœ—  â”‚                         â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                              â”‚
â”‚  Output: .liye/traces/<trace_id>/                                            â”‚
â”‚          â”œâ”€â”€ events.ndjson, verdict.json, verdict.md, replay.json           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Layer 1: é¢†åŸŸå±‚ (Domain Implementations)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      Amazon Growth Engine                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚                     12+ Professional Agents                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ PPC Strategist â”‚ Keyword Architect â”‚ Listing Optimizer â”‚ ...    â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚                     Data Infrastructure                          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Amazon Ads API â”‚ DuckDB â”‚ Qdrant â”‚ SellerSprite MCP             â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  Future Domains: Shopify â”‚ Google Ads â”‚ Supply Chain â”‚ ...                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Integration Pattern: MCP Federation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP Federation Hub                       â”‚
â”‚              (LiYe Governed Tool Call Gateway)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MCP Client: Moltbot Gateway                                â”‚
â”‚  â”œâ”€ consume: liye://governance/*                            â”‚
â”‚  â”œâ”€ consume: amazon://strategy/*                            â”‚
â”‚  â””â”€ consume: amazon://execution/*                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MCP Hub: LiYe OS                                           â”‚
â”‚  â”œâ”€ provide: liye://governance/p3-gate                      â”‚
â”‚  â”œâ”€ provide: liye://governance/verdict-log                  â”‚
â”‚  â”œâ”€ provide: liye://governance/trace-recorder               â”‚
â”‚  â””â”€ enforce: policy-engine (guardrails)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MCP Server: Amazon Growth Engine                           â”‚
â”‚  â”œâ”€ provide: amazon://strategy/wasted-spend                 â”‚
â”‚  â”œâ”€ provide: amazon://strategy/bid-optimizer                â”‚
â”‚  â”œâ”€ provide: amazon://execution/action-spec                 â”‚
â”‚  â”œâ”€ provide: amazon://execution/dry-run                     â”‚
â”‚  â””â”€ provide: amazon://data/campaign-audit                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Memory System Integration

### 2.1 Three-Layer Memory Model

ä¸‰ä¸ªç³»ç»Ÿçš„è®°å¿†èƒ½åŠ›å½¢æˆäº’è¡¥çš„ä¸‰å±‚æ¨¡å‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç»Ÿä¸€è®°å¿†æ¶æ„ (Unified Memory)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Layer 1: å·¥ä½œè®°å¿† (Working Memory) - Moltbot æä¾›                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡ (session context)                                â”‚  â”‚
â”‚  â”‚  â€¢ å¯¹è¯å†å² (conversation history)                                 â”‚  â”‚
â”‚  â”‚  â€¢ ä¸´æ—¶çŠ¶æ€ (/compact å¯å‹ç¼©)                                      â”‚  â”‚
â”‚  â”‚  â€¢ ç”Ÿå‘½å‘¨æœŸ: ä¼šè¯å†…                                                â”‚  â”‚
â”‚  â”‚  â€¢ å­˜å‚¨: ~/.clawdbot/sessions/                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“ é‡è¦å†…å®¹æ²‰æ·€                              â”‚
â”‚                                                                         â”‚
â”‚  Layer 2: é•¿æœŸçŸ¥è¯† (Long-term Knowledge) - LiYe MaaP æä¾›               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ è§„èŒƒæœ¯è¯­è¡¨ (knowledge/glossary/*.yaml)                          â”‚  â”‚
â”‚  â”‚  â€¢ é¢†åŸŸçŸ¥è¯† (Packs)                                                â”‚  â”‚
â”‚  â”‚  â€¢ å†³ç­–å†å² (ADRs)                                                 â”‚  â”‚
â”‚  â”‚  â€¢ ç”Ÿå‘½å‘¨æœŸ: æ°¸ä¹… (ç‰ˆæœ¬åŒ– concept_id@version)                      â”‚  â”‚
â”‚  â”‚  â€¢ æ²»ç†: æ¼‚ç§»æ£€æµ‹ + é˜»å¡æ‰§è¡Œ                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“ æ‰§è¡Œæ—¶æ£€ç´¢                               â”‚
â”‚                                                                         â”‚
â”‚  Layer 3: æ‰§è¡Œè¯æ® (Execution Evidence) - LiYe Governance æä¾›          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ å·¥å…·è°ƒç”¨è®°å½• (.liye/traces/)                                    â”‚  â”‚
â”‚  â”‚  â€¢ å†³ç­–åˆ¤å®š (verdicts/)                                            â”‚  â”‚
â”‚  â”‚  â€¢ å¯å›æ”¾è¯æ® (replay.json)                                        â”‚  â”‚
â”‚  â”‚  â€¢ ç”Ÿå‘½å‘¨æœŸ: æ°¸ä¹… (ä¸å¯å˜, å¯å®¡è®¡)                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Memory Conflict Resolution

| èƒ½åŠ›ç»´åº¦ | Moltbot | LiYe OS MaaP | è§£å†³æ–¹æ¡ˆ |
|---------|---------|--------------|---------|
| ä¼šè¯æŒä¹…åŒ– | sessions_history | memory_bootstrap | Moltbot=çŸ­æœŸå¯¹è¯ï¼ŒLiYe=é•¿æœŸçŸ¥è¯† |
| çŸ¥è¯†å­˜å‚¨ | ~/clawd/*.md | knowledge/glossary/ | Moltbot=äººè®¾ï¼ŒLiYe=æœ¯è¯­å®šä¹‰ |
| è·¨ä¼šè¯æ£€ç´¢ | sessions_list | claude-mem search | Moltbot=å¯¹è¯å›é¡¾ï¼ŒLiYe=çŸ¥è¯†æ£€ç´¢ |
| æ‰§è¡Œè¿½æº¯ | âŒ æ—  | traces/verdicts | LiYe ç‹¬æœ‰æä¾› |
| æ¼‚ç§»æ£€æµ‹ | âŒ æ—  | glossary drift detector | LiYe ç‹¬æœ‰æä¾› |

### 2.3 Knowledge Crystallization Flow

```
ç”¨æˆ·æ¶ˆæ¯ (ä»»æ„æ¸ é“)
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Moltbot Gateway: åŠ è½½å·¥ä½œè®°å¿†                                            â”‚
â”‚ sessions_history(session_id) â†’ æœ€è¿‘å¯¹è¯ä¸Šä¸‹æ–‡                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LiYe Memory Bootstrap: æ³¨å…¥é•¿æœŸçŸ¥è¯†                                      â”‚
â”‚ detect_domain() â†’ load_glossary(top_30) â†’ inject_recent_adrs()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent Execution: æ‰§è¡Œå‰è®°å¿†æ£€æŸ¥                                          â”‚
â”‚ claude-mem search â†’ glossary lookup â†’ (å†™æ“ä½œ) P3 Gate                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LiYe Governance: è®°å½•æ‰§è¡Œè¯æ®                                            â”‚
â”‚ Gate â†’ Verdict â†’ Replay â†’ Evidence Package                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Knowledge Crystallization: é‡è¦å†…å®¹æ²‰æ·€                                  â”‚
â”‚ ç”¨æˆ·çº æ­£æ¦‚å¿µ â†’ æ›´æ–° glossary                                             â”‚
â”‚ é‡å¤§å†³ç­– â†’ åˆ›å»º ADR                                                      â”‚
â”‚ æ–°æœ¯è¯­å‘ç° â†’ ææ¡ˆåŠ å…¥æœ¯è¯­è¡¨                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Agent Execution Integration

### 3.1 Unified Dispatcher (åˆ†å±‚è°ƒåº¦å™¨)

**å•ä¸€å¤§è„‘åŸåˆ™**: LiYe æ˜¯å”¯ä¸€å†³ç­–å¤§è„‘ï¼ŒMoltbot ä»…ä½œä¸º Thin-Agentï¼ˆç­–ç•¥æ‰§è¡Œå™¨ï¼‰ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Unified Dispatcher                        â”‚
â”‚     (ç­–ç•¥ç”± LiYe ä¸‹å‘/ç‰ˆæœ¬åŒ–ï¼ŒMoltbot ä»…åŠ è½½å¹¶æ‰§è¡Œè·¯ç”±)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ç”¨æˆ·è¯·æ±‚                                                    â”‚
â”‚      â†“                                                      â”‚
â”‚  åŠ è½½ LiYe è·¯ç”±ç­–ç•¥ (policy_version)                         â”‚
â”‚      â†“                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              è·¯ç”±æ‰§è¡Œ (ä¸åšæ¨ç†å†³ç­–)                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ è¯»æ“ä½œ          â”‚  â”‚ å†™æ“ä½œ                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“          â”‚  â”‚      â†“                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ LiYe Executor   â”‚  â”‚  LiYe P3 Gate           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ (trace_lite)    â”‚  â”‚  (full_evidence_chain)  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  Pi Agent èŒè´£: ä»…è´Ÿè´£å‘ˆç°/æ ¼å¼åŒ–/Canvas å±•ç¤º                â”‚
â”‚                 ä¸è´Ÿè´£å†³ç­–ä¸å·¥å…·é€‰æ‹©                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Routing Rules

**æ ¸å¿ƒåŸåˆ™**: æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»ç»è¿‡ LiYe æ²»ç†å±‚ï¼Œä¿è¯å®¡è®¡é“¾å®Œæ•´æ€§ã€‚

```yaml
routing_rules:
  # è¯»æ“ä½œ - èµ° LiYe Executor + trace_lite
  - condition:
      action_type: "read"
      risk_level: "low"
    route_to: "liye_executor"
    governance: "trace_lite"
    notes: "è®°å½•ä½†ä¸é˜»å¡ï¼Œä¿è¯å®¡è®¡é“¾ä¸æ–­è£‚"
    examples:
      - "ä»Šå¤© ACOS å¤šå°‘ï¼Ÿ"
      - "æŸ¥çœ‹æœ€è¿‘çš„å¹¿å‘ŠæŠ¥å‘Š"

  # åˆ†æç±» - èµ° LiYe Executor + T1/T2/T3 æ£€æŸ¥
  - condition:
      action_type: "analyze"
    route_to: "liye_executor"
    governance: "t1_t2_t3_check"
    examples:
      - "ä¸ºä»€ä¹ˆ ACOS ä¸Šå‡äº†ï¼Ÿ"
      - "è¯Šæ–­ Campaign B çš„é—®é¢˜"

  # å†™/åˆ /å‘é€/æ‰§è¡Œ - èµ° P3 Gate + å®Œæ•´è¯æ®é“¾
  - condition:
      action_type: ["write", "delete", "send", "execute"]
    route_to: "liye_p3_gate"
    governance: "full_evidence_chain"
    examples:
      - "æ·»åŠ å¦å®šå…³é”®è¯"
      - "è°ƒæ•´å‡ºä»·"

fallback:
  on_governance_error: "block_and_notify"
  on_timeout: "degrade_to_readonly"
```

---

## 4. Safety & Governance Integration

### 4.1 Three-Layer Protection Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä¸‰å±‚é˜²æŠ¤æ¶æ„ (Three-Layer Protection)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Layer 1: Moltbot æ²™ç®±éš”ç¦» (Process Isolation)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ æœºåˆ¶: Docker Sandbox                                           â”‚  â”‚
â”‚  â”‚  â€¢ èŒƒå›´: non-main sessions (groups/channels)                      â”‚  â”‚
â”‚  â”‚  â€¢ é˜»æ­¢: ç³»ç»Ÿèµ„æºè®¿é—®ã€è·¨ä¼šè¯æ±¡æŸ“                                  â”‚  â”‚
â”‚  â”‚  â€¢ é…ç½®: agents.defaults.sandbox.mode: 'non-main'                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“ é€šè¿‡å                                    â”‚
â”‚                                                                         â”‚
â”‚  Layer 2: LiYe P3 Gate (Decision Isolation)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ æœºåˆ¶: Gate â†’ Verdict â†’ Replay â†’ Evidence                       â”‚  â”‚
â”‚  â”‚  â€¢ èŒƒå›´: æ‰€æœ‰å†™æ“ä½œ                                                â”‚  â”‚
â”‚  â”‚  â€¢ é˜»æ­¢: æœªæˆæƒçš„ä¸šåŠ¡æ“ä½œã€æ— è¯æ®çš„å†³ç­–                            â”‚  â”‚
â”‚  â”‚  â€¢ å†³ç­–: ALLOW / DEGRADE / BLOCK / UNKNOWN                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“ ALLOW å                                  â”‚
â”‚                                                                         â”‚
â”‚  Layer 3: Amazon Guardrails (Business Isolation)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ æœºåˆ¶: 4å±‚æŠ¤æ  (Write/Amplitude/Batch/Freeze)                   â”‚  â”‚
â”‚  â”‚  â€¢ èŒƒå›´: Amazon API è°ƒç”¨                                          â”‚  â”‚
â”‚  â”‚  â€¢ é˜»æ­¢: è¶…é™æ“ä½œ (Bid Â±30%, Budget Â±50%, Batch â‰¤20)              â”‚  â”‚
â”‚  â”‚  â€¢ é…ç½®: config/guardrails.yaml                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Execution Flow with Safety Gates

```
ç”¨æˆ·è¯·æ±‚: "ç»™ Campaign A æ·»åŠ  'cheap' ä½œä¸ºå¦å®šå…³é”®è¯"
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gate 1: Moltbot Sandbox                                                 â”‚
â”‚ âœ“ Session éªŒè¯é€šè¿‡                                                      â”‚
â”‚ âœ“ ç”¨æˆ·èº«ä»½ç¡®è®¤                                                          â”‚
â”‚ âœ“ éæ²™ç®±æ¨¡å¼ (main session)                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gate 2: LiYe P3 Gate                                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Input:                                                              â”‚ â”‚
â”‚ â”‚   task: "Add negative keyword"                                      â”‚ â”‚
â”‚ â”‚   action_type: "write"                                              â”‚ â”‚
â”‚ â”‚   tool: "amazon://execution/add-negative-keyword"                   â”‚ â”‚
â”‚ â”‚   arguments: { campaign_id: "A", keyword: "cheap", match: "phrase" }â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Evaluation:                                                         â”‚ â”‚
â”‚ â”‚   âœ“ Action in whitelist                                             â”‚ â”‚
â”‚ â”‚   âœ“ Evidence provided (wasted spend data)                           â”‚ â”‚
â”‚ â”‚   âœ“ Rollback plan exists                                            â”‚ â”‚
â”‚ â”‚   âœ“ Risk level: MEDIUM (acceptable)                                 â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Verdict: ALLOW                                                      â”‚ â”‚
â”‚ â”‚ trace_id: trace-1706529600-abc123                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gate 3: Amazon Guardrails                                               â”‚
â”‚ âœ“ Write rule: trace_id exists                                           â”‚
â”‚ âœ“ Batch rule: 1 keyword â‰¤ 20 limit                                      â”‚
â”‚ âœ“ Freeze rule: campaign not frozen                                      â”‚
â”‚ â†’ PASS: Execute allowed                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execution: Amazon Ads API                                               â”‚
â”‚ POST /v2/sp/negative-keywords                                           â”‚
â”‚ â†’ Success: keyword_id = nk-789                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Evidence Recording                                                      â”‚
â”‚ .liye/traces/trace-1706529600-abc123/                                   â”‚
â”‚ â”œâ”€â”€ events.ndjson (action + result)                                     â”‚
â”‚ â”œâ”€â”€ verdict.json (ALLOW + reasons)                                      â”‚
â”‚ â”œâ”€â”€ verdict.md (human readable)                                         â”‚
â”‚ â””â”€â”€ replay.json (deterministic verification)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Skill System Integration

### 5.1 Interoperability Protocol

ClawdHub (Moltbot) å’Œ SkillRegistry (LiYe) é€šè¿‡äº’æ“ä½œåè®®èåˆï¼š

```yaml
# ClawdHub Skill å®šä¹‰ (è°ƒç”¨ LiYe Skill)
# ~/clawd/skills/liye-ppc-strategist/SKILL.md

name: liye-ppc-strategist
type: remote
description: PPC optimization through LiYe Governance
endpoint: liye://skills/ppc-strategist
requires_governance: true

tools:
  - name: analyze_campaign
    description: Analyze campaign performance with evidence chain
    input:
      campaign_id: string
      date_range: { start: date, end: date }
    output:
      acos: number
      recommendations: array
      trace_id: string

  - name: add_negative_keyword
    description: Add negative keyword (governed)
    input:
      campaign_id: string
      keyword: string
      match_type: phrase | exact
    output:
      success: boolean
      trace_id: string
      verdict: ALLOW | BLOCK
```

```typescript
// LiYe å‘å¸ƒ Skills ä¸º MCP Server
// src/runtime/mcp/servers/skills_server.mjs

const skillsServer = {
  name: 'liye-skills',
  transport: 'stdio',

  tools: {
    'skill/ppc-strategist': {
      handler: async (args) => {
        // 1. ç»è¿‡ P3 Gate
        const verdict = await p3Gate.evaluate(args);
        if (verdict.decision !== 'ALLOW') {
          return { blocked: true, reason: verdict.summary };
        }

        // 2. è°ƒç”¨ Amazon Engine
        const result = await amazonEngine.execute(args);

        // 3. è®°å½•è¯æ®
        await traceWriter.record(verdict.trace_id, result);

        return { ...result, trace_id: verdict.trace_id };
      }
    },

    'skill/keyword-architect': { /* ... */ },
    'skill/listing-optimizer': { /* ... */ },
  }
};
```

### 5.2 Skill Mapping

| ClawdHub Skill | LiYe Skill | Amazon Agent | Governance |
|----------------|------------|--------------|------------|
| liye-ppc-strategist | skill/ppc-strategist | ppc-strategist | P3 Gate |
| liye-keyword-architect | skill/keyword-architect | keyword-architect | P3 Gate |
| liye-listing-optimizer | skill/listing-optimizer | listing-optimizer | P3 Gate |
| liye-market-analyst | skill/market-analyst | market-analyst | T1/T2/T3 |
| liye-campaign-audit | skill/campaign-audit | diagnostic-architect | Read-only |

---

## 6. Integration Roadmap

### 6.1 Updated Integration Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ Phase â”‚ ç›®æ ‡å¹³å°  â”‚               é›†æˆæ–¹å¼               â”‚     çŠ¶æ€      â”‚ PR  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P0    â”‚ CrewAI    â”‚ Python API (GovernedMCPToolProvider) â”‚ âœ… Merged     â”‚ #74 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P1    â”‚ Dify      â”‚ HTTP Gateway + OpenAPI               â”‚ â³ PR Created â”‚ #75 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P2    â”‚ Langflow  â”‚ HTTP Gateway / Python Component      â”‚ ğŸ“‹ Planned    â”‚ -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P3    â”‚ n8n       â”‚ HTTP Gateway                         â”‚ ğŸ“‹ Planned    â”‚ -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P4    â”‚ AutoGen   â”‚ Python API                           â”‚ ğŸ“‹ Planned    â”‚ -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P5    â”‚ LangGraph â”‚ Python API                           â”‚ ğŸ“‹ Planned    â”‚ -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ P6    â”‚ Moltbot   â”‚ MCP Federation + ClawdHub Skill      â”‚ ğŸ†• NEW        â”‚ -   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase â”‚     è§¦è¾¾å±‚æ‰©å±•    â”‚                     è¯´æ˜                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ M1    â”‚ Moltbot Gateway  â”‚ å¤šæ¶ˆæ¯æ¸ é“å…¥å£ï¼ˆWhatsApp/Telegram/Voice/Canvasï¼‰ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ M2    â”‚ å¾®ä¿¡/ä¼å¾®/é£ä¹¦   â”‚ ä¸­å›½å¸‚åœºè§¦è¾¾ï¼ˆéœ€è¦å•ç‹¬å¼€å‘ï¼‰                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Implementation Phases

#### Phase 0: Validation (2 weeks)

```yaml
goal: "éªŒè¯ä¸‰æ–¹é›†æˆæŠ€æœ¯å¯è¡Œæ€§"

constraints:
  - "Phase 0 ä¸å¼•å…¥å†™æ“ä½œ"
  - "Phase 0 ä¸å¼•å…¥æ–°æœåŠ¡å®ä½“"
  - "ä»…éªŒè¯ Moltbotâ†’LiYe Gatewayâ†’Amazon MCP çš„å¯è¡Œæ€§ä¸ trace_id è´¯é€š"
  - "çœŸæ­£é€š WhatsApp/Telegram æ”¾åˆ°åç»­ M1 æ‰©å±•"
  - "Phase 0 å¯ç”¨ Moltbot æœ¬åœ° channel/WS æ³¨å…¥åšç­‰ä»·éªŒè¯"

deliverables:
  - moltbot_mcp_config:
      description: "Moltbot æ¶ˆè´¹ LiYe HTTP Gateway é…ç½®"
      file: "examples/moltbot/mcp_config.yaml"

  - amazon_mcp_tools:
      description: "Amazon Engine 3 ä¸ªæ ¸å¿ƒå·¥å…·æš´éœ²"
      tools:
        - amazon://strategy/campaign-audit
        - amazon://strategy/wasted-spend-detect
        - amazon://execution/dry-run

  - e2e_demo:
      description: "ç«¯åˆ°ç«¯éªŒè¯ Demo"
      flow: "WhatsApp â†’ Moltbot â†’ LiYe Gateway â†’ Amazon MCP â†’ ç»“æœ"

success_criteria:
  - "ç”¨æˆ·é€šè¿‡ WhatsApp æŸ¥è¯¢ PPC è¡¨ç°æˆåŠŸ"
  - "å“åº”åŒ…å« trace_id"
  - "è¯æ®é“¾æ­£ç¡®å†™å…¥ .liye/traces/"
```

#### Phase 1: P6 Integration (4 weeks)

```yaml
goal: "Moltbot æˆä¸º P6 é›†æˆç›®æ ‡"

deliverables:
  - clawdhub_skills:
      - name: liye-governance
        description: "LiYe Governance Kernel æŠ€èƒ½åŒ…"
        tools: [p3-gate, verdict-log, trace-recorder]

      - name: amazon-growth
        description: "Amazon Growth Engine æŠ€èƒ½åŒ…"
        tools: [campaign-audit, add-negative-keyword, bid-optimizer]

  - canvas_components:
      - VerdictViewer: "å†³ç­–è§£é‡Šå¯è§†åŒ–"
      - TraceTimeline: "è¯æ®é“¾æ—¶é—´çº¿"
      - ActionProposal: "åŠ¨ä½œææ¡ˆå¡ç‰‡"

  - documentation:
      file: "docs/integrations/MOLTBOT_GOVERNANCE_V1.md"

success_criteria:
  - "ClawdHub å¯å‘ç°å¹¶å®‰è£…ä¸¤ä¸ªæŠ€èƒ½åŒ…"
  - "Canvas æ­£ç¡®æ¸²æŸ“ Verdict ä¿¡æ¯"
  - "æ‰€æœ‰å†™æ“ä½œç»è¿‡ P3 Gate"
```

#### Phase 2: Full Integration (6 weeks)

```yaml
goal: "ç”Ÿäº§çº§ä¸‰æ–¹èåˆ"

deliverables:
  - unified_dispatcher:
      description: "åˆ†å±‚è°ƒåº¦å™¨å®ç°"
      file: "src/runtime/dispatcher/unified.mjs"

  - multi_tenant:
      description: "å¤šç§Ÿæˆ·æ¶æ„"
      mappings:
        - Moltbot Session â†” LiYe Domain
        - LiYe Domain â†” Amazon Profile

  - cross_platform_bridge:
      - moltbot_dify_bridge: "Moltbot â†’ Dify å·¥ä½œæµè§¦å‘"
      - moltbot_crewai_bridge: "Moltbot â†’ CrewAI Crew è§¦å‘"

  - trace_aggregation:
      description: "è·¨å¹³å° trace_id å…³è”"
      service: "src/runtime/trace/aggregator.mjs"

  - audit_dashboard:
      description: "ç»Ÿä¸€å®¡è®¡ä»ªè¡¨ç›˜"
      tech: "React + Canvas Component"

success_criteria:
  - "å¤šç”¨æˆ·å¤šåº—é“ºæ­£ç¡®éš”ç¦»"
  - "è·¨å¹³å°è°ƒç”¨å¯è¿½æº¯"
  - "å®¡è®¡ä»ªè¡¨ç›˜æ­£ç¡®å±•ç¤ºæ‰€æœ‰ trace"
```

#### Phase 3: Ecosystem Expansion (Ongoing)

```yaml
goal: "å¹³å°åŒ– & æ–°é¢†åŸŸæ‰©å±•"

workstreams:
  - domain_template:
      description: "æ–°é¢†åŸŸæ¥å…¥æ¡†æ¶"
      includes: [domain_scaffold, agent_generator, contract_template]

  - developer_platform:
      - api_docs: "OpenAPI 3.0 æ–‡æ¡£"
      - sdk: "@liye-os/sdk (npm)"
      - console: "å¼€å‘è€…æ§åˆ¶å°"

  - new_channels:
      - wechat: "å¾®ä¿¡/ä¼ä¸šå¾®ä¿¡"
      - dingtalk: "é’‰é’‰"
      - feishu: "é£ä¹¦"

  - new_domains:
      - shopify: "Shopify åº—é“ºä¼˜åŒ–"
      - google_ads: "Google Ads ç®¡ç†"
      - seo: "ç‹¬ç«‹ç«™ SEO"
      - supply_chain: "ä¾›åº”é“¾ç®¡ç†"
```

---

## 7. Interface Specifications

### 7.1 Unified Event Schema

```typescript
interface UnifiedEvent {
  // æ ‡è¯†
  event_id: string;          // UUID v4
  trace_id: string;          // è·¨ç³»ç»Ÿè¿½è¸ª ID

  // æ¥æº
  source: 'moltbot' | 'liye' | 'amazon';
  channel?: string;          // WhatsApp, Telegram, Voice, etc.
  session_id?: string;       // Moltbot session ID

  // ç±»å‹
  type: EventType;
  subtype?: string;

  // è½½è·
  payload: Record<string, any>;

  // æ²»ç†
  governance?: {
    verdict?: 'ALLOW' | 'DEGRADE' | 'BLOCK' | 'UNKNOWN';
    evidence_path?: string;
    risk_level?: 'LOW' | 'MEDIUM' | 'HIGH';
    reasons?: string[];
  };

  // æ—¶é—´
  timestamp: string;         // ISO 8601
  ttl?: number;              // äº‹ä»¶è¿‡æœŸæ—¶é—´ (ç§’)
}

type EventType =
  | 'user.message'           // ç”¨æˆ·æ¶ˆæ¯
  | 'agent.request'          // Agent è¯·æ±‚
  | 'agent.response'         // Agent å“åº”
  | 'governance.check'       // æ²»ç†æ£€æŸ¥
  | 'governance.verdict'     // æ²»ç†åˆ¤å†³
  | 'action.proposed'        // åŠ¨ä½œææ¡ˆ
  | 'action.approved'        // åŠ¨ä½œæ‰¹å‡†
  | 'action.executed'        // åŠ¨ä½œæ‰§è¡Œ
  | 'action.rolled_back'     // åŠ¨ä½œå›æ»š
  | 'memory.crystallized';   // çŸ¥è¯†æ²‰æ·€
```

### 7.2 MCP Tool Definitions

```typescript
// LiYe Governance MCP Server
const liyeGovernanceTools = {
  'liye://governance/p3-gate': {
    description: 'Evaluate action through P3 safety gate',
    inputSchema: {
      type: 'object',
      required: ['task', 'proposed_actions'],
      properties: {
        task: { type: 'string' },
        context: { type: 'object' },
        proposed_actions: {
          type: 'array',
          items: {
            type: 'object',
            required: ['action_type', 'tool'],
            properties: {
              action_type: {
                type: 'string',
                enum: ['read', 'write', 'delete', 'send', 'execute']
              },
              tool: { type: 'string' },
              server: { type: 'string' },
              arguments: { type: 'object' }
            }
          }
        }
      }
    },
    outputSchema: {
      type: 'object',
      properties: {
        ok: { type: 'boolean' },
        decision: { type: 'string', enum: ['ALLOW', 'DEGRADE', 'BLOCK', 'UNKNOWN'] },
        trace_id: { type: 'string' },
        evidence_path: { type: 'string' },
        verdict_summary: { type: 'string' },
        result: { type: 'object' },
        error: { type: 'string' }
      }
    }
  }
};

// Amazon Growth Engine MCP Server
const amazonEngineTools = {
  'amazon://strategy/campaign-audit': {
    description: 'Audit campaign performance with ACOS analysis',
    requires_governance: true,
    risk_level: 'LOW',
    inputSchema: {
      type: 'object',
      required: ['profile_id', 'campaign_id'],
      properties: {
        profile_id: { type: 'string' },
        campaign_id: { type: 'string' },
        date_range: {
          type: 'object',
          properties: {
            start: { type: 'string', format: 'date' },
            end: { type: 'string', format: 'date' }
          }
        }
      }
    }
  },

  'amazon://execution/add-negative-keyword': {
    description: 'Add negative keyword to campaign',
    requires_governance: true,
    risk_level: 'MEDIUM',
    guardrails: {
      max_batch: 20,
      require_evidence: true,
      require_rollback: true
    },
    inputSchema: {
      type: 'object',
      required: ['profile_id', 'campaign_id', 'keyword', 'match_type'],
      properties: {
        profile_id: { type: 'string' },
        campaign_id: { type: 'string' },
        keyword: { type: 'string' },
        match_type: { type: 'string', enum: ['phrase', 'exact'] }
      }
    }
  }
};
```

---

## 8. Risk Assessment & Mitigation

### 8.1 Risk Matrix

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Moltbot å‡çº§ä¸å…¼å®¹ | HIGH | MEDIUM | MCP åè®®å±‚éš”ç¦»ï¼Œç‰ˆæœ¬é”å®š |
| Amazon API é™æµ | MEDIUM | HIGH | è¯·æ±‚é˜Ÿåˆ— + æŒ‡æ•°é€€é¿ + é…é¢ç›‘æ§ |
| æ²»ç†å±‚æ€§èƒ½ç“¶é¢ˆ | MEDIUM | LOW | P3 Gate å¼‚æ­¥åŒ– + ç¼“å­˜å¸¸è§åˆ¤å†³ |
| å¤šç§Ÿæˆ·æ•°æ®æ³„éœ² | CRITICAL | LOW | ä¸¥æ ¼ Session éš”ç¦» + å®¡è®¡æ—¥å¿— |
| ActionSpec ç‰ˆæœ¬å†²çª | MEDIUM | LOW | Frozen ç‰ˆæœ¬ç­–ç•¥ + å‘åå…¼å®¹ |
| è®°å¿†ç³»ç»Ÿå†²çª | LOW | MEDIUM | ä¸‰å±‚æ¨¡å‹æ˜ç¡®è¾¹ç•Œ |
| Agent æ‰§è¡Œå†²çª | MEDIUM | MEDIUM | åˆ†å±‚è°ƒåº¦å™¨ + è·¯ç”±è§„åˆ™ |

### 8.2 Fallback Strategies

```yaml
fallback_strategies:
  governance_timeout:
    trigger: "P3 Gate å“åº” > 5s"
    action: "é™çº§åˆ°åªè¯»æ¨¡å¼ï¼Œé€šçŸ¥ç”¨æˆ·"

  mcp_connection_lost:
    trigger: "MCP Server è¿æ¥æ–­å¼€"
    action: "è‡ªåŠ¨é‡è¿ (3æ¬¡)ï¼Œå¤±è´¥åˆ™é˜»æ­¢å†™æ“ä½œ"

  amazon_api_error:
    trigger: "Amazon Ads API è¿”å› 5xx"
    action: "å…¥é˜Ÿé‡è¯•ï¼ŒæŒ‡æ•°é€€é¿ (max 5 retries)"

  memory_bootstrap_failure:
    trigger: "memory_bootstrap.mjs å¤±è´¥"
    action: "é™çº§åˆ°åŸºç¡€æ¨¡å¼ (æ— é¢†åŸŸçŸ¥è¯†æ³¨å…¥)"

  trace_write_failure:
    trigger: ".liye/traces/ å†™å…¥å¤±è´¥"
    action: "å†…å­˜ç¼“å†² + å¼‚æ­¥é‡è¯•ï¼Œä¸é˜»å¡ä¸»æµç¨‹"
```

---

## 9. Success Metrics

### 9.1 Technical Metrics

| Metric | Target | Measurement |
|--------|--------|-------------|
| End-to-end latency (read) | < 2s | P95 response time |
| End-to-end latency (write) | < 5s | P95 response time |
| Governance coverage | 100% | % of write ops through P3 Gate |
| Trace completeness | 100% | % of executions with evidence |
| Memory retrieval accuracy | > 90% | Relevance of claude-mem results |

### 9.2 Business Metrics

| Metric | Target | Measurement |
|--------|--------|-------------|
| User adoption | 100 active users | Monthly active users via Moltbot |
| Channel coverage | 5+ channels | Unique channels with traffic |
| Action success rate | > 95% | % of ALLOW verdicts executed successfully |
| User satisfaction | > 4.5/5 | Post-interaction survey |

---

## 10. Appendix

### 10.1 Glossary

| Term | Definition |
|------|------------|
| **MaaP** | Memory as a Product - LiYe çš„è®°å¿†äº§å“åŒ–æ¶æ„ |
| **P3 Gate** | LiYe çš„å®‰å…¨æ‰§è¡Œé—¨ (Phase 3 Execution Gate) |
| **ActionSpec** | Amazon Engine çš„åŠ¨ä½œè§„æ ¼åˆçº¦ |
| **ClawdHub** | Moltbot çš„æŠ€èƒ½å¸‚åœº |
| **Pi Agent** | Moltbot çš„è½»é‡çº§ Agent æ‰§è¡Œå™¨ |
| **Verdict** | LiYe æ²»ç†å±‚çš„å†³ç­–åˆ¤å®š |
| **Trace** | æ‰§è¡Œè¯æ®é“¾è®°å½• |

### 10.2 Related Documents

- `docs/architecture/ARCHITECTURE_CONSTITUTION.md` - LiYe æ¶æ„å®ªæ³•
- `docs/architecture/MEMORY_ANTI_FORGETTING_DESIGN.md` - è®°å¿†é˜²é—å¿˜è®¾è®¡
- `docs/integrations/CREWAI_GOVERNANCE_INTEGRATION_V1.md` - CrewAI é›†æˆ
- `docs/integrations/DIFY_GOVERNED_DEMO_V1.md` - Dify é›†æˆ
- Amazon Engine: `docs/architecture/SYSTEM_OVERVIEW.md`

### 10.3 Change Log

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2026-01-29 | Claude + Expert Team | Initial version |

---

**Document Status**: Approved for Implementation
**Next Review**: 2026-02-28
**Owner**: LiYe OS Core Team
