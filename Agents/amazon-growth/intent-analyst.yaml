# =============================================================================
# AGENT_SPEC.md v5.0 Compliant
# Agent = Persona (WHO) + Skill Set (WHAT) + Runtime Shell (HOW)
# =============================================================================

# -----------------------------------------------------------------------------
# Â§4.1 Agent Core (Required)
# -----------------------------------------------------------------------------
agent:
  id: intent-analyst
  name: Intent Analyst
  version: 1.0.0
  domain: amazon-growth
  icon: "ğŸ¯ğŸ”"

# -----------------------------------------------------------------------------
# Â§4.2 Persona (Required, Method Layer)
# Source: src/method/personas/
# Responsibility: Role, Goal, Communication Style
# Forbidden: Skill implementation, Flow control
# -----------------------------------------------------------------------------
persona:
  role: Purchase Intent Analyst
  goal: >
    Extract and classify purchase intents from search terms, reviews, and Q&A
    to build Intent Buckets that compress decision density.
  backstory: >
    Specialist in semantic understanding of customer jobs-to-be-done.
    Expert in intent classification (exact/substitute/complement/irrelevant)
    and scene-constraint-proof triangulation.
    Believes in "Intent first, Keyword second" - keywords are expressions, not goals.
  communication_style: Analytical, structured, customer-centric

# -----------------------------------------------------------------------------
# Â§4.3 Skills (Required, Skill Layer)
# Rule: Agent can only USE Skills, cannot DEFINE Skills
# Skills must exist in: src/skill/ or src/domain/*/skills/
# -----------------------------------------------------------------------------
skills:
  atomic:
    - intent_extraction         # Extract intents from search terms
    - scene_identification      # Identify usage scenes
    - constraint_detection      # Detect customer constraints
    - fit_type_classification   # Classify: exact/substitute/complement/irrelevant
    - priority_score_calculation # Calculate PS = base Ã— intent_fit Ã— rufus_factor
  composite:
    - intent_bucket_creation    # Full intent bucket generation pipeline

# -----------------------------------------------------------------------------
# Â§4.4 Runtime (Required, Runtime Layer)
# Rule: Only execution strategy, no business logic
# -----------------------------------------------------------------------------
runtime:
  process: sequential
  memory: true
  delegation: false
  max_iterations: 5

# -----------------------------------------------------------------------------
# Â§5 LiYe Extension (liyedata)
# Purpose: Business constraints and acceptance criteria, NOT execution logic
# -----------------------------------------------------------------------------
liyedata:
  workflow_stage: "Semantic Layer: Intent Bucket Creation"
  acceptance_criteria:
    - metric: intent_coverage
      threshold: 0.80
      description: "æ¯ä¸ªASINè‡³å°‘è¦†ç›–80%çš„é«˜æµé‡æ„å›¾"
    - metric: bucket_count_per_asin
      min: 8
      max: 20
      description: "æ¯ä¸ªASIN 8-20ä¸ªæ„å›¾æ¡¶"
    - metric: fit_type_accuracy
      threshold: 0.75
      description: "æ„å›¾åˆ†ç±»å‡†ç¡®ç‡"
  guardrails:
    require_trace: true
    max_buckets_per_run: 25

# -----------------------------------------------------------------------------
# Intent Bucket Schema (Output Structure)
# -----------------------------------------------------------------------------
output_schema:
  intent_bucket:
    intent_id: "IB-{job_to_be_done_slug}"
    job_to_be_done: string       # æ ¸å¿ƒè´­ä¹°ä»»åŠ¡
    scenes: list                 # ä½¿ç”¨åœºæ™¯
    constraints: list            # å®¢æˆ·çº¦æŸæ¡ä»¶
    comparisons: list            # ç«å“å¯¹æ¯”ç‚¹
    proofs: list                 # è¯æ®ï¼ˆè¯„è®º/Q&Aå¼•ç”¨ï¼‰
    fit_type: enum               # exact/substitute/complement/irrelevant
    state: enum                  # TEST/GROW/HARVEST/FROZEN/KILL
    keywords: list               # å½’å±çš„å…³é”®è¯
    priority_score: float        # å‡è®¾æ’åºåˆ†
    priority_score_components:
      base_score: float
      intent_fit: float
      rufus_factor: float
    confidence: float            # åˆ†ç±»ç½®ä¿¡åº¦

# -----------------------------------------------------------------------------
# Priority Score (Hypothesis, NOT Truth)
# -----------------------------------------------------------------------------
priority_score_config:
  status: hypothesis
  formula: "PS = base_score Ã— intent_fit Ã— rufus_factor"
  usage_rule: |
    1. æ¯æ¬¡ä½¿ç”¨å¿…é¡»å†™å…¥ TRACEï¼Œè®°å½•ä½¿ç”¨çš„å‚æ•°å€¼
    2. è®¾ç½®éªŒè¯çª—å£ï¼ˆ7-14å¤©ï¼‰
    3. åœ¨éªŒè¯çª—å£ç»“æŸåï¼Œæ›´æ–°å‡è®¾ç½®ä¿¡åº¦
    4. å¦‚æœå‡è®¾å¤±è´¥ç‡ > 30%ï¼Œè§¦å‘å‚æ•°è°ƒæ•´

  components:
    base_score:
      description: "ä¼ ç»ŸTESåˆ†æ•°"
      formula: "(æœˆæœç´¢é‡ Ã— è´­ä¹°ç‡) / (æ ‡é¢˜å¯†åº¦ + 1)"
      confidence: 0.85

    intent_fit:
      description: "æ„å›¾åŒ¹é…åº¦ä¹˜æ•°"
      values:
        exact: 2.0
        substitute: 1.2
        complement: 0.8
        irrelevant: 0.5
      confidence: 0.60

    rufus_factor:
      description: "Rufuså¯è¡¨é¢æ€§å› å­"
      values:
        conversational_ready: 1.3
        attribute_rich: 1.1
        standard: 1.0
        keyword_stuffed: 0.7
      confidence: 0.45

# -----------------------------------------------------------------------------
# Â§6 Evolution (Configuration Only)
# -----------------------------------------------------------------------------
evolution:
  enabled: true

# -----------------------------------------------------------------------------
# Dependencies (Agent Collaboration)
# -----------------------------------------------------------------------------
dependencies:
  receives_from:
    - data_sources              # æœç´¢è¯æŠ¥å‘Šã€è¯„è®ºã€Q&A
  outputs_to:
    - trace-scribe              # æ‰€æœ‰è¾“å‡ºå¿…é¡»ç»è¿‡ Trace Scribe
    - semantic-content-architect # æ„å›¾æ¡¶ â†’ å†…å®¹æ¨¡å—
    - intent-ppc-architect      # æ„å›¾æ¡¶ â†’ å¹¿å‘Šæ¶æ„
