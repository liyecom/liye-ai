# ==============================================
# Listing A/B Testing Framework Configuration
# Amazon Growth OS
# ==============================================

# Experiment Settings
experiment:
  # Minimum test duration (days)
  min_duration_days: 14
  max_duration_days: 90

  # Statistical significance threshold
  confidence_level: 0.95  # 95% confidence

  # Minimum sample size per variant
  min_sample_size: 100

  # Auto-stop if clear winner
  auto_stop:
    enabled: true
    confidence_threshold: 0.99  # 99% confidence to auto-stop
    min_lift: 0.05  # Minimum 5% lift to declare winner

# Element Types for A/B Testing
testable_elements:
  title:
    enabled: true
    max_variants: 2
    metrics:
      - click_through_rate
      - conversion_rate
      - impressions
    amazon_api: "TITLE"  # Amazon Experiments API element type

  bullet_points:
    enabled: true
    max_variants: 2
    metrics:
      - conversion_rate
      - add_to_cart_rate
      - time_on_page
    amazon_api: "BULLET_POINTS"

  main_image:
    enabled: true
    max_variants: 2
    metrics:
      - click_through_rate
      - conversion_rate
    amazon_api: "MAIN_IMAGE"

  a_plus_content:
    enabled: true
    max_variants: 2
    metrics:
      - conversion_rate
      - time_on_page
    amazon_api: "A_PLUS_CONTENT"

  price:
    enabled: false  # Requires special handling
    max_variants: 2
    metrics:
      - conversion_rate
      - revenue
      - units_sold
    amazon_api: null  # Not available via Experiments API

# NLP Bullet Point Optimization
nlp_optimization:
  enabled: true

  # Source data for optimization
  sources:
    positive_reviews:
      weight: 0.40
      min_rating: 4  # Only use 4+ star reviews
    top_competitors:
      weight: 0.30
      max_competitors: 5
    search_terms:
      weight: 0.30

  # Feature extraction patterns
  feature_categories:
    quality:
      keywords: ["durable", "sturdy", "quality", "well-made", "solid", "thick"]
      weight: 1.2
    functionality:
      keywords: ["works great", "easy to use", "effective", "convenient", "practical"]
      weight: 1.1
    appearance:
      keywords: ["looks", "beautiful", "stylish", "nice", "attractive", "sleek"]
      weight: 1.0
    value:
      keywords: ["worth", "value", "price", "affordable", "cheap", "bargain"]
      weight: 0.9
    size_fit:
      keywords: ["size", "fit", "perfect", "just right", "dimensions"]
      weight: 1.0
    cleaning:
      keywords: ["easy to clean", "washable", "wipe", "stain", "maintenance"]
      weight: 0.8

  # Bullet point structure
  bullet_structure:
    max_bullets: 5
    max_chars_per_bullet: 500
    format: "HEADER + benefit + proof"  # [FEATURE] - Benefit statement (proof point)
    keyword_density_target: 0.02  # 2% target

  # Optimization strategies
  strategies:
    - name: "benefit_first"
      description: "Lead with customer benefit, then feature"
      priority: 1
    - name: "problem_solution"
      description: "State problem, then how product solves it"
      priority: 2
    - name: "social_proof"
      description: "Include customer language and validation"
      priority: 3
    - name: "sensory_language"
      description: "Use descriptive, sensory words"
      priority: 4

# Experiment Tracking
tracking:
  # DuckDB table schema
  table_name: "fact_experiments"

  # Metrics to track
  primary_metrics:
    - name: "conversion_rate"
      calculation: "orders / sessions"
      higher_is_better: true
    - name: "click_through_rate"
      calculation: "clicks / impressions"
      higher_is_better: true

  secondary_metrics:
    - name: "add_to_cart_rate"
      calculation: "add_to_carts / sessions"
      higher_is_better: true
    - name: "revenue_per_session"
      calculation: "revenue / sessions"
      higher_is_better: true
    - name: "units_per_order"
      calculation: "units / orders"
      higher_is_better: true

  # Segmentation dimensions
  segments:
    - traffic_source  # organic, ppc, external
    - device_type     # mobile, desktop
    - day_of_week
    - time_of_day

# Amazon Experiments API Integration
amazon_api:
  # API endpoint (mock for now, real integration later)
  base_url: "https://sellingpartnerapi-na.amazon.com"
  endpoints:
    list_experiments: "/experiments/2021-04-28/experiments"
    create_experiment: "/experiments/2021-04-28/experiments"
    get_experiment: "/experiments/2021-04-28/experiments/{experimentId}"
    stop_experiment: "/experiments/2021-04-28/experiments/{experimentId}/stop"
    get_results: "/experiments/2021-04-28/experiments/{experimentId}/results"

  # Rate limits
  rate_limits:
    requests_per_second: 1
    daily_quota: 100

  # Retry settings
  retry:
    max_retries: 3
    backoff_factor: 2.0

# Reporting
reporting:
  # Report generation schedule
  schedule:
    daily_summary: "08:00"  # Local time
    weekly_detailed: "sunday"

  # Report sections
  sections:
    - experiment_status
    - variant_comparison
    - statistical_analysis
    - recommendations
    - next_steps

  # Alert thresholds
  alerts:
    - name: "underperforming_variant"
      condition: "variant_cvr < control_cvr * 0.9"  # 10% worse
      severity: "warning"
    - name: "experiment_winner"
      condition: "confidence >= 0.95 AND lift >= 0.05"
      severity: "info"
    - name: "insufficient_traffic"
      condition: "daily_sessions < 50"
      severity: "warning"

# Historical Data
history:
  # How long to keep experiment data
  retention_days: 365

  # Archive completed experiments
  archive:
    enabled: true
    path: "data/experiments/archive/"

