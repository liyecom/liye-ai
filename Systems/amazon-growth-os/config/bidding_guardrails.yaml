# ==============================================
# Bidding Guardrails Configuration
# Amazon Growth OS - Auto Bid Adjustment System
# Version: 1.0
# ==============================================

# Global Safety Limits
global_limits:
  max_bid_usd: 5.00              # Absolute maximum bid per click
  min_bid_usd: 0.10              # Minimum bid per click
  max_daily_budget_usd: 500.00   # Daily spend cap
  max_bid_change_pct: 30         # Max single adjustment (%)
  min_bid_change_pct: 5          # Min adjustment to apply (%)
  cooldown_hours: 24             # Wait time between adjustments for same keyword

# ACOS-Based Rules
acos_rules:
  # When ACOS is too high, reduce bid
  reduce_bid:
    - condition: "acos > 50"
      action: "reduce"
      adjustment_pct: -25
      priority: 1
      description: "Critical ACOS - aggressive reduction"

    - condition: "acos > 40"
      action: "reduce"
      adjustment_pct: -15
      priority: 2
      description: "High ACOS - moderate reduction"

    - condition: "acos > 30"
      action: "reduce"
      adjustment_pct: -10
      priority: 3
      description: "Above target ACOS - slight reduction"

  # When ACOS is good, consider increasing bid
  increase_bid:
    - condition: "acos < 15 AND orders >= 3"
      action: "increase"
      adjustment_pct: 20
      priority: 1
      description: "Excellent ACOS with volume - increase"

    - condition: "acos < 20 AND orders >= 2"
      action: "increase"
      adjustment_pct: 15
      priority: 2
      description: "Good ACOS with sales - moderate increase"

    - condition: "acos < 25 AND orders >= 1"
      action: "increase"
      adjustment_pct: 10
      priority: 3
      description: "Healthy ACOS - slight increase"

# Performance-Based Rules
performance_rules:
  # Zero conversion keywords
  zero_conversion:
    - condition: "clicks >= 20 AND orders == 0"
      action: "pause"
      priority: 1
      description: "High clicks, zero sales - pause"

    - condition: "clicks >= 10 AND orders == 0 AND spend > 5"
      action: "reduce"
      adjustment_pct: -30
      priority: 2
      description: "Spending without converting - reduce"

  # High CTR but low conversion
  high_ctr_low_cvr:
    - condition: "ctr > 0.02 AND cvr < 0.05 AND clicks >= 10"
      action: "reduce"
      adjustment_pct: -15
      priority: 3
      description: "Good clicks, poor conversion"

  # Low impression keywords
  low_impression:
    - condition: "impressions < 100 AND spend < 1"
      action: "increase"
      adjustment_pct: 20
      priority: 4
      description: "Need more visibility"

# Keyword Lifecycle Rules (based on organic rank)
lifecycle_rules:
  # TEST phase (Rank > 20)
  test:
    max_bid_pct_of_suggested: 80    # Max 80% of suggested bid
    max_daily_spend_usd: 10
    review_after_days: 7

  # GROW phase (Rank 8-20)
  grow:
    max_bid_pct_of_suggested: 120   # Can bid 20% above suggested
    max_daily_spend_usd: 30
    target_placement: "top_of_search"

  # HARVEST phase (Rank 1-7)
  harvest:
    max_bid_pct_of_suggested: 100   # Stay at suggested bid
    max_daily_spend_usd: 50
    focus: "profitability"

  # DEFEND phase (Brand terms)
  defend:
    max_bid_pct_of_suggested: 150   # Aggressive bidding for brand
    max_daily_spend_usd: 100
    always_top_of_search: true

# Time-Based Rules
time_rules:
  # Weekend adjustments
  weekend:
    enabled: true
    bid_modifier: -10              # Reduce bids 10% on weekends

  # Prime Day / Holiday
  high_traffic_days:
    enabled: true
    dates: []                       # Add dates like "2025-07-15"
    bid_modifier: 20               # Increase 20% during high traffic

# Alert Thresholds
alerts:
  critical:
    - "acos > 60"
    - "daily_spend > daily_budget * 0.9"
    - "no_orders_with_spend > 20"

  warning:
    - "acos > 40"
    - "ctr < 0.001"
    - "bid > suggested_bid * 1.5"

# Execution Settings
execution:
  mode: "dry_run"                  # Options: dry_run, manual_approve, auto_execute
  require_approval_above_usd: 2.00 # Require approval for bids above this
  log_all_decisions: true
  rollback_enabled: true
  rollback_window_hours: 48

# ASIN-Specific Overrides (optional)
asin_overrides:
  # Example:
  # B0C5Q9Y6YF:
  #   max_bid_usd: 3.00
  #   target_acos: 25
  #   priority_keywords:
  #     - "washable runner rug"
  #     - "kitchen floor mat"
