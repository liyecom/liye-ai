# ==============================================
# Conversion Rate (CVR) Prediction Model Configuration
# Amazon Growth OS
# ==============================================

# Model Settings
model:
  # Current active model type
  active_model: "rule_based"  # Options: "rule_based", "gradient_boosting", "neural_network"

  # Version tracking
  version: "1.0.0"
  last_trained: null
  training_samples: 0

  # Minimum samples required for ML training
  min_training_samples: 500

# Feature Engineering
features:
  # Keyword-level features
  keyword:
    search_volume:
      weight: 0.15
      normalization: "log"  # log, minmax, standard
      missing_value: 1000

    title_density:
      weight: 0.10
      normalization: "minmax"
      missing_value: 50
      # Lower density = less competition = higher CVR potential

    purchase_rate:
      weight: 0.20
      normalization: "minmax"
      missing_value: 0.05
      # From SellersSprite data

    organic_rank:
      weight: 0.20
      normalization: "inverse_log"  # Rank 1 = highest, 100+ = lowest
      missing_value: 50

    ppc_position:
      weight: 0.10
      normalization: "inverse"
      missing_value: 5

  # ASIN-level features
  asin:
    rating:
      weight: 0.10
      normalization: "linear"  # 1-5 stars
      missing_value: 4.0

    review_count:
      weight: 0.05
      normalization: "log"
      missing_value: 100

    price_competitiveness:
      weight: 0.05
      normalization: "minmax"
      missing_value: 0.5
      # 1.0 = cheapest in category, 0.0 = most expensive

    image_quality_score:
      weight: 0.05
      normalization: "linear"  # 0-10 scale
      missing_value: 7.0

# Rule-Based Model Parameters
rule_based:
  # Base CVR by category (from industry benchmarks)
  base_cvr_by_category:
    home_kitchen: 0.12
    electronics: 0.08
    clothing: 0.06
    beauty: 0.10
    sports: 0.09
    default: 0.10

  # Rank multipliers (higher rank = higher CVR)
  rank_multipliers:
    - rank_max: 3
      multiplier: 1.5
    - rank_max: 7
      multiplier: 1.3
    - rank_max: 15
      multiplier: 1.1
    - rank_max: 30
      multiplier: 1.0
    - rank_max: 50
      multiplier: 0.8
    - rank_max: 100
      multiplier: 0.5
    - rank_max: 999
      multiplier: 0.3

  # Rating adjustments
  rating_adjustments:
    - rating_min: 4.5
      adjustment: 1.2
    - rating_min: 4.0
      adjustment: 1.0
    - rating_min: 3.5
      adjustment: 0.8
    - rating_min: 3.0
      adjustment: 0.6
    - rating_min: 0.0
      adjustment: 0.4

  # Review count adjustments (social proof)
  review_adjustments:
    - count_min: 1000
      adjustment: 1.2
    - count_min: 500
      adjustment: 1.1
    - count_min: 100
      adjustment: 1.0
    - count_min: 50
      adjustment: 0.9
    - count_min: 10
      adjustment: 0.7
    - count_min: 0
      adjustment: 0.5

  # Title density impact (competition proxy)
  density_adjustments:
    - density_max: 10
      adjustment: 1.3  # Low competition
    - density_max: 30
      adjustment: 1.1
    - density_max: 50
      adjustment: 1.0
    - density_max: 100
      adjustment: 0.9
    - density_max: 999
      adjustment: 0.7  # High competition

# ML Model Parameters (for future training)
ml_model:
  gradient_boosting:
    n_estimators: 100
    max_depth: 5
    learning_rate: 0.1
    min_samples_split: 10

  # Feature importance thresholds
  feature_selection:
    min_importance: 0.01

  # Cross-validation
  cv_folds: 5

  # Hyperparameter tuning
  hyperparameter_tuning:
    enabled: false
    n_trials: 50

# Prediction Output
output:
  # CVR prediction range
  min_cvr: 0.01  # 1%
  max_cvr: 0.35  # 35%

  # Confidence levels
  confidence_thresholds:
    high: 0.8
    medium: 0.5
    low: 0.3

# Bid Optimization Integration
bid_integration:
  # How to use CVR prediction in bidding
  enabled: true

  # CVR to bid multiplier mapping
  cvr_multipliers:
    - cvr_min: 0.20
      bid_multiplier: 1.5  # High CVR = can bid higher
    - cvr_min: 0.15
      bid_multiplier: 1.3
    - cvr_min: 0.10
      bid_multiplier: 1.1
    - cvr_min: 0.08
      bid_multiplier: 1.0
    - cvr_min: 0.05
      bid_multiplier: 0.8
    - cvr_min: 0.00
      bid_multiplier: 0.6  # Low CVR = bid conservatively

# Training Settings
training:
  # Schedule
  frequency: "monthly"
  min_days_between_training: 7

  # Data requirements
  lookback_days: 90
  min_conversions: 10  # Minimum conversions per keyword

  # Model evaluation
  test_size: 0.2
  metrics:
    - mae
    - rmse
    - r2

  # Model persistence
  model_path: "models/cvr_predictor.pkl"
  save_training_data: true
