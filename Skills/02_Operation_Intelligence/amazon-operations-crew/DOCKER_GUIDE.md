# Docker ä½¿ç”¨æŒ‡å—ï¼ˆå°ç™½ç‰ˆï¼‰

## è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

æŠŠ Amazon Growth OS è£…è¿›ä¸€ä¸ª"ä¾¿å½“ç›’"ï¼ˆDockerï¼‰ï¼Œå¸¦å»ä»»ä½•ç”µè„‘éƒ½èƒ½ç”¨ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker ä¾¿å½“ç›’                         â”‚
â”‚                                                         â”‚
â”‚   ğŸ Python + æ‰€æœ‰ä¾èµ–                                  â”‚
â”‚   ğŸ“Š Streamlit ä»ªè¡¨ç›˜                                   â”‚
â”‚   ğŸ—„ï¸ Qdrant çŸ¥è¯†åº“                                      â”‚
â”‚   ğŸ¤– CrewAI å¤šæ™ºèƒ½ä½“                                    â”‚
â”‚   ğŸ“ ä½ çš„é…ç½®å’Œæ•°æ®                                      â”‚
â”‚                                                         â”‚
â”‚   æ‰“å¼€ç›–å­å°±èƒ½ç”¨ï¼                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬ä¸€æ­¥ï¼šå®‰è£… Dockerï¼ˆä¹°ä¾¿å½“ç›’ï¼‰

### Mac ç”¨æˆ·

1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼šhttps://www.docker.com/products/docker-desktop/
2. ç‚¹å‡» "Download for Mac"
3. åŒå‡»ä¸‹è½½çš„ `.dmg` æ–‡ä»¶
4. æŠŠ Docker å›¾æ ‡æ‹–åˆ° Applications æ–‡ä»¶å¤¹
5. æ‰“å¼€ Docker Desktopï¼ˆç¬¬ä¸€æ¬¡è¦ç­‰å‡ åˆ†é’Ÿï¼‰
6. çœ‹åˆ°é¡¶éƒ¨èœå•æ å‡ºç° ğŸ³ é²¸é±¼å›¾æ ‡ = å®‰è£…æˆåŠŸï¼

### Windows ç”¨æˆ·

1. åŒä¸Šï¼Œä¸‹è½½ Windows ç‰ˆæœ¬
2. åŒå‡»å®‰è£…ï¼Œä¸€è·¯ Next
3. å¯èƒ½éœ€è¦é‡å¯ç”µè„‘
4. æ‰“å¼€ Docker Desktop

### éªŒè¯å®‰è£…

æ‰“å¼€ç»ˆç«¯ï¼ˆMacï¼‰æˆ–å‘½ä»¤æç¤ºç¬¦ï¼ˆWindowsï¼‰ï¼Œè¾“å…¥ï¼š

```bash
docker --version
```

çœ‹åˆ°ç±»ä¼¼ `Docker version 24.0.7` = æˆåŠŸï¼

---

## ç¬¬äºŒæ­¥ï¼šé…ç½®å¯†é’¥ï¼ˆå‡†å¤‡é£Ÿæï¼‰

åœ¨ä½¿ç”¨å‰ï¼Œéœ€è¦è®¾ç½®ä½ çš„ API å¯†é’¥ã€‚

### æ–¹æ³• Aï¼šåˆ›å»º .env æ–‡ä»¶ï¼ˆæ¨èï¼‰

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/Documents/liye_workspace/LiYe_OS/Skills/02_Operation_Intelligence/amazon-operations-crew

# å¤åˆ¶æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„å¯†é’¥
nano .env  # æˆ–ç”¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€
```

éœ€è¦å¡«å†™çš„å†…å®¹ï¼š
```
ANTHROPIC_API_KEY=sk-ant-api03-ä½ çš„å¯†é’¥...
SELLERSPRITE_API_KEY=ä½ çš„å–å®¶ç²¾çµå¯†é’¥ï¼ˆå¯é€‰ï¼‰
```

### æ–¹æ³• Bï¼šåœ¨å‘½ä»¤ä¸­ç›´æ¥ä¼ å…¥

```bash
ANTHROPIC_API_KEY=sk-ant-xxx docker-compose up
```

---

## ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æœåŠ¡ï¼ˆå¼€åƒï¼ï¼‰

### ä¸€é”®å¯åŠ¨

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/Documents/liye_workspace/LiYe_OS/Skills/02_Operation_Intelligence/amazon-operations-crew

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d
```

### å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

```
ä½ è¾“å…¥ï¼šdocker-compose up -d

Docker å¼€å§‹å·¥ä½œï¼š
â”œâ”€â”€ ğŸ“¦ ä¸‹è½½ Python ç¯å¢ƒé•œåƒï¼ˆç¬¬ä¸€æ¬¡ï¼Œçº¦ 2-5 åˆ†é’Ÿï¼‰
â”œâ”€â”€ ğŸ“¦ ä¸‹è½½ Qdrant é•œåƒï¼ˆç¬¬ä¸€æ¬¡ï¼Œçº¦ 1-2 åˆ†é’Ÿï¼‰
â”œâ”€â”€ ğŸ”§ å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆç¬¬ä¸€æ¬¡ï¼Œçº¦ 3-5 åˆ†é’Ÿï¼‰
â”œâ”€â”€ ğŸš€ å¯åŠ¨ Qdrant æ•°æ®åº“
â””â”€â”€ ğŸš€ å¯åŠ¨ Dashboard ä»ªè¡¨ç›˜

å®Œæˆåæ˜¾ç¤ºï¼š
âœ” Container amazon-growth-qdrant    Started
âœ” Container amazon-growth-dashboard Started
```

### è®¿é—®æœåŠ¡

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š**http://localhost:8501**

ä½ ä¼šçœ‹åˆ° Amazon Growth OS ä»ªè¡¨ç›˜ï¼

---

## å¸¸ç”¨å‘½ä»¤ï¼ˆä¾¿å½“ç›’æ“ä½œæ‰‹å†Œï¼‰

### æŸ¥çœ‹çŠ¶æ€ï¼ˆä¾¿å½“ç›’é‡Œæœ‰ä»€ä¹ˆï¼Ÿï¼‰

```bash
docker-compose ps
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
NAME                        STATUS    PORTS
amazon-growth-dashboard     running   0.0.0.0:8501->8501/tcp
amazon-growth-qdrant        running   0.0.0.0:6333->6333/tcp
```

### æŸ¥çœ‹æ—¥å¿—ï¼ˆä¾¿å½“ç›’é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼‰

```bash
# çœ‹æ‰€æœ‰æ—¥å¿—
docker-compose logs

# åªçœ‹ Dashboard æ—¥å¿—
docker-compose logs dashboard

# å®æ—¶è·Ÿè¸ªæ—¥å¿—
docker-compose logs -f
```

### åœæ­¢æœåŠ¡ï¼ˆç›–ä¸Šä¾¿å½“ç›’ï¼‰

```bash
docker-compose down
```

### é‡å¯æœåŠ¡ï¼ˆé‡æ–°åŠ çƒ­ï¼‰

```bash
docker-compose restart
```

### å®Œå…¨æ¸…ç†ï¼ˆæ¸…æ´—ä¾¿å½“ç›’ï¼‰

```bash
# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker-compose down

# åˆ é™¤æ•°æ®å·ï¼ˆè°¨æ…ï¼ä¼šåˆ é™¤çŸ¥è¯†åº“æ•°æ®ï¼‰
docker-compose down -v
```

---

## è¿è¡Œåˆ†æä»»åŠ¡ï¼ˆä½¿ç”¨ä¾¿å½“ç›’é‡Œçš„å·¥å…·ï¼‰

### æ–¹å¼ 1ï¼šé€šè¿‡ Dashboard ç•Œé¢

1. æ‰“å¼€ http://localhost:8501
2. åœ¨ç•Œé¢ä¸Šæ“ä½œ

### æ–¹å¼ 2ï¼šé€šè¿‡å‘½ä»¤è¡Œ

```bash
# è¿è¡Œ Launch æ¨¡å¼ï¼ˆæ–°å“å¼€å‘ï¼‰
docker-compose run --rm cli main.py --mode launch --product "Yoga Mat"

# è¿è¡Œ Optimize æ¨¡å¼ï¼ˆè€å“ä¼˜åŒ–ï¼‰
docker-compose run --rm cli main.py --mode optimize --asin "B0C5Q9Y6YF"

# è¿è¡Œä»»æ„ Python è„šæœ¬
docker-compose run --rm cli tools/analyze_ca_comprehensive.py
```

---

## åœ¨æ–°ç”µè„‘ä¸Šä½¿ç”¨ï¼ˆæ¬å®¶æŒ‡å—ï¼‰

### æ‰“åŒ…å¸¦èµ°

éœ€è¦å¸¦èµ°çš„"è¡Œæ"ï¼š
```
å¿…é¡»å¸¦ï¼š
â”œâ”€â”€ .env              # API å¯†é’¥
â”œâ”€â”€ data/             # ä½ çš„æ•°æ®ï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä»¥é‡æ–°ç”Ÿæˆï¼‰
â””â”€â”€ config/*.yaml     # è‡ªå®šä¹‰é…ç½®ï¼ˆå¦‚æœæ”¹è¿‡ï¼‰

ä¸ç”¨å¸¦ï¼ˆDocker ä¼šè‡ªåŠ¨ä¸‹è½½ï¼‰ï¼š
â”œâ”€â”€ Python
â”œâ”€â”€ æ‰€æœ‰ä¾èµ–åº“
â”œâ”€â”€ Qdrant æ•°æ®åº“
â””â”€â”€ ä»£ç ï¼ˆä» Git å…‹éš†ï¼‰
```

### æ–°ç”µè„‘è®¾ç½®æ­¥éª¤

```bash
# 1. å®‰è£… Docker Desktopï¼ˆè§ç¬¬ä¸€æ­¥ï¼‰

# 2. å…‹éš†ä»£ç 
git clone git@github.com:YOUR_USERNAME/LiYe_OS.git
cd LiYe_OS/Skills/02_Operation_Intelligence/amazon-operations-crew

# 3. å¤åˆ¶ä½ çš„ .env æ–‡ä»¶ï¼ˆä»å¤‡ä»½æˆ–é‡æ–°åˆ›å»ºï¼‰
cp /path/to/backup/.env .

# 4. å¯åŠ¨ï¼
docker-compose up -d

# 5. ï¼ˆå¯é€‰ï¼‰é‡å»ºçŸ¥è¯†åº“ç´¢å¼•
docker-compose run --rm cli scripts/incremental_index.py

# å®Œæˆï¼æ‰“å¼€ http://localhost:8501 å¼€å§‹ä½¿ç”¨
```

---

## æ•…éšœæ’é™¤ï¼ˆä¾¿å½“ç›’å‡ºé—®é¢˜äº†ï¼Ÿï¼‰

### é—®é¢˜ 1ï¼šç«¯å£è¢«å ç”¨

```
Error: port 8501 is already in use
```

**è§£å†³**ï¼š
```bash
# æŸ¥çœ‹è°å ç”¨äº†ç«¯å£
lsof -i :8501

# æ€æ‰å ç”¨çš„è¿›ç¨‹
kill -9 <PID>

# æˆ–è€…æ¢ä¸ªç«¯å£
# ç¼–è¾‘ docker-compose.yamlï¼ŒæŠŠ 8501:8501 æ”¹æˆ 8502:8501
```

### é—®é¢˜ 2ï¼šDocker æ²¡å¯åŠ¨

```
Cannot connect to Docker daemon
```

**è§£å†³**ï¼šæ‰“å¼€ Docker Desktop åº”ç”¨ç¨‹åºï¼Œç­‰é²¸é±¼å›¾æ ‡å‡ºç°

### é—®é¢˜ 3ï¼šå†…å­˜ä¸è¶³

```
Error: out of memory
```

**è§£å†³**ï¼š
1. æ‰“å¼€ Docker Desktop â†’ Settings â†’ Resources
2. æŠŠ Memory è°ƒé«˜åˆ° 4GB æˆ–ä»¥ä¸Š

### é—®é¢˜ 4ï¼šç¬¬ä¸€æ¬¡å¯åŠ¨å¾ˆæ…¢

**æ­£å¸¸ï¼** ç¬¬ä¸€æ¬¡éœ€è¦ä¸‹è½½é•œåƒå’Œå®‰è£…ä¾èµ–ï¼Œçº¦ 5-10 åˆ†é’Ÿã€‚åç»­å¯åŠ¨åªéœ€å‡ ç§’ã€‚

### é—®é¢˜ 5ï¼šAPI å¯†é’¥æ— æ•ˆ

```
Invalid API key
```

**è§£å†³**ï¼šæ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„å¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œæ²¡æœ‰å¤šä½™ç©ºæ ¼

---

## è¿›é˜¶ï¼šè‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ç«¯å£

ç¼–è¾‘ `docker-compose.yaml`ï¼š

```yaml
services:
  dashboard:
    ports:
      - "9999:8501"  # æ”¹æˆ 9999 ç«¯å£
```

### æŒä¹…åŒ–çŸ¥è¯†åº“

çŸ¥è¯†åº“æ•°æ®é»˜è®¤ä¿å­˜åœ¨ Docker volume ä¸­ã€‚å¦‚æœæƒ³ä¿å­˜åˆ°æœ¬åœ°ï¼š

```yaml
services:
  qdrant:
    volumes:
      - ./qdrant_data:/qdrant/storage  # ä¿å­˜åˆ°å½“å‰ç›®å½•
```

---

## æ€»ç»“ï¼šä¸‰æ¡å‘½ä»¤æå®š

```bash
# å¯åŠ¨
docker-compose up -d

# è®¿é—®
open http://localhost:8501

# åœæ­¢
docker-compose down
```

å°±è¿™ä¹ˆç®€å•ï¼ğŸ‰
